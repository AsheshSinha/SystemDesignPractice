<mxfile host="app.diagrams.net" modified="2024-04-30T04:22:40.901Z" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15" etag="PR-bN7XkvZBHpTh80HUk" version="24.3.1" type="github">
  <diagram name="Page-1" id="3VYbJmwqDZBETqcIFygg">
    <mxGraphModel dx="2413" dy="1190" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-1" value="&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;Questions:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;1. Which type of chat application are we supposed to build? There are mainly two categories of chat applications,&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;First category -&lt;/span&gt;1:1 plus group chats like WhatsApp, messenger.&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;Second is slack , discord, teams like chat application which supports large organisations.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;Ans:  The first category&lt;/span&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;2. Do we need to focus on multi device syncing feature? - yes&lt;/span&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;3. Assuming this would be a global application - yes&lt;/span&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;4. What types of messages are supported ? - text &lt;/span&gt;&lt;/font&gt;&lt;/font&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;only to start with&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;5. What is maximum size of a message ?- 100000 characters&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;6. How many members a group will have ? - max 500&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;7. How many DAU ? - 10 million&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;Based on the answers above we will need to design the following features:&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;1. A one on one with groups supported chat application&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;2. Focus on the backend part&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;3. Implement the seen/delivered feature&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;font-size: small; white-space: pre;&quot;&gt;4. Also implement the last seen at feature, unread messages and mentions&lt;/span&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;font-size: small; white-space: pre;&quot;&gt;5. If two devices are there then one device should reflect unread status if the new message is read on the other device&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;Non - functional:&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;1. Highly available&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;2. High scalability&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;BOE - &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;Requests per second - 10 * 10 ^6 * (20 messages per day) / 10 ^ 5 = 2000 messages per second&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;Storage per day - 10 * 10 ^ 6  * 10 * 10 ^ 3  (10KB average message size) = 10 ^ 12 = 1 TB  per day&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;Concepts:&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;The chat application can be separated to 3 different components:&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;1. Stateless services - This will be mainly used for user profile creation/maintenance, Authentication, group creation,&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;User add/removal from groups, read/unread, count of mentions or unread messages etc&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;2. Stateful messaging - This is the core of this application which will support real time message exchanges, typing status, online status&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;3. Third Party integrations - Push notifications for new messages.&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;" style="text;strokeColor=none;align=left;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="40" y="80" width="690" height="460" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-2" value="&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Chat Application System design&lt;/font&gt;&lt;/div&gt;" style="text;strokeColor=none;align=left;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="40" y="30" width="310" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-3" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;High Level Design&lt;/font&gt;" style="text;strokeColor=none;align=left;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="40" y="548" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-7" value="Load Balancer" style="outlineConnect=0;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;shape=mxgraph.aws3.application_load_balancer;fillColor=#F58536;gradientColor=none;" parent="1" vertex="1">
          <mxGeometry x="111" y="740" width="69" height="72" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-11" value="KV store (Base)" style="image;html=1;image=img/lib/clip_art/computers/Database_128x128.png" parent="1" vertex="1">
          <mxGeometry x="555" y="1080" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-12" value="App Servers&lt;div&gt;All stateless Service&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="85.5" y="900" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-16" value="Meta Data storage" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#C925D1;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.rds_postgresql_instance;" parent="1" vertex="1">
          <mxGeometry x="-190" y="891" width="78" height="78" as="geometry" />
        </mxCell>
        <mxCell id="y-Os3jITyolEBnI4brBV-3" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;How do we establish real time messaging&lt;/font&gt; - We have multiple ways to do it like long polling, short polling and web sockets. However because polling could result it querying for data even when there is no message, it could become expensive option and not a good way of implementing real time communication.&amp;nbsp;&lt;div&gt;Websockets being a persistent bidirectional full duplex connection seems to be an ideal choice.However one challenge with web sockets is that since it&#39;s a stateful connection we would need to maintain the mapping of client and server to transmit the message to the desired party.&lt;/div&gt;" style="text;strokeColor=none;align=left;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="780" y="30" width="620" height="120" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-4" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="280" y="585" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-3" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="UpVBmO8LdcwkQg-ua9Jf-4" vertex="1">
          <mxGeometry width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-4" value="" style="outlineConnect=0;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;shape=mxgraph.aws3.mobile_client;fillColor=#D2D3D3;gradientColor=none;" parent="UpVBmO8LdcwkQg-ua9Jf-4" vertex="1">
          <mxGeometry x="75" y="10" width="30" height="40" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-5" value="" style="verticalLabelPosition=bottom;html=1;verticalAlign=top;align=center;strokeColor=none;fillColor=#00BEF2;shape=mxgraph.azure.laptop;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-4" vertex="1">
          <mxGeometry x="10.5" y="15" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-6" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" target="HWvaaGP3WwTQ4oXDmzbK-7" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="340" y="650" as="sourcePoint" />
            <mxPoint x="410" y="690" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-7" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" target="UpVBmO8LdcwkQg-ua9Jf-8" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="340" y="650" as="sourcePoint" />
            <mxPoint x="440" y="690" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-9" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="HWvaaGP3WwTQ4oXDmzbK-7" target="HWvaaGP3WwTQ4oXDmzbK-12" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="30" y="750" as="sourcePoint" />
            <mxPoint x="110" y="750" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-10" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="HWvaaGP3WwTQ4oXDmzbK-12" target="HWvaaGP3WwTQ4oXDmzbK-16" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="220" y="1040" as="sourcePoint" />
            <mxPoint x="300" y="1040" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-11" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="UpVBmO8LdcwkQg-ua9Jf-8" target="HWvaaGP3WwTQ4oXDmzbK-11" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="500" y="1010" as="sourcePoint" />
            <mxPoint x="580" y="1010" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-14" value="&lt;div&gt;&lt;font style=&quot;font-size: 19px;&quot;&gt;List of stateless services:&lt;/font&gt;&lt;/div&gt;If we think what should happen when the app loads:&lt;div&gt;1. First if this is the first time login then the auth module service should be invoked&lt;/div&gt;&lt;div&gt;2. Next we should be able to load all the groups the user is associated with and the group members&lt;/div&gt;&lt;div&gt;3. API to fetch Images of the user and groups&lt;/div&gt;&lt;div&gt;4. API to fetch the unread messages and it&#39;s count&lt;/div&gt;&lt;div&gt;5. When clicked on group we should fetch all the historical messages in paginated fashion&lt;/div&gt;&lt;div&gt;6. API to show the lastSeenAt time.&lt;/div&gt;&lt;div&gt;7. One API to confirm message seenAt time in a group and 1:1 chat.&lt;/div&gt;&lt;div&gt;8. Update mention count service - Using the mention count table we can increase the count if any mention found. This can be shown just beside the group name. Also once the group is opened we can reset it to zero.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;To support the above features stateless http services can be created with below table structures:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;strokeColor=none;align=left;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="780" y="210" width="630" height="240" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-22" value="Group User Map" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;" parent="1" vertex="1">
          <mxGeometry x="1140" y="430" width="492" height="70" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-23" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="UpVBmO8LdcwkQg-ua9Jf-22" vertex="1">
          <mxGeometry y="30" width="492" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-24" value="gid" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-23" vertex="1">
          <mxGeometry width="82" height="40" as="geometry">
            <mxRectangle width="82" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-25" value="user_id" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-23" vertex="1">
          <mxGeometry x="82" width="82" height="40" as="geometry">
            <mxRectangle width="82" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-26" value="group name" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-23" vertex="1">
          <mxGeometry x="164" width="76" height="40" as="geometry">
            <mxRectangle width="76" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-27" value="lastActiveTime" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-23" vertex="1">
          <mxGeometry x="240" width="88" height="40" as="geometry">
            <mxRectangle width="88" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-28" value="group_img" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-23" vertex="1">
          <mxGeometry x="328" width="82" height="40" as="geometry">
            <mxRectangle width="82" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-69" value="desc" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-23" vertex="1">
          <mxGeometry x="410" width="82" height="40" as="geometry">
            <mxRectangle width="82" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-48" value="Users" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;" parent="1" vertex="1">
          <mxGeometry x="780" y="430" width="350" height="70" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-49" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="UpVBmO8LdcwkQg-ua9Jf-48" vertex="1">
          <mxGeometry y="30" width="350" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-50" value="User_id" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-49" vertex="1">
          <mxGeometry width="66" height="40" as="geometry">
            <mxRectangle width="66" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-51" value="User Name" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-49" vertex="1">
          <mxGeometry x="66" width="66" height="40" as="geometry">
            <mxRectangle width="66" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-52" value="lastSeenAt" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-49" vertex="1">
          <mxGeometry x="132" width="78" height="40" as="geometry">
            <mxRectangle width="78" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-53" value="user_img" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-49" vertex="1">
          <mxGeometry x="210" width="70" height="40" as="geometry">
            <mxRectangle width="70" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-54" value="status_msg" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-49" vertex="1">
          <mxGeometry x="280" width="70" height="40" as="geometry">
            <mxRectangle width="70" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-56" value="Group Message (sharded by group_id | Hbase)" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;" parent="1" vertex="1">
          <mxGeometry x="780" y="550" width="420" height="70" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-57" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="UpVBmO8LdcwkQg-ua9Jf-56" vertex="1">
          <mxGeometry y="30" width="420" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-58" value="message_id" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-57" vertex="1">
          <mxGeometry width="66" height="40" as="geometry">
            <mxRectangle width="66" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-59" value="sentAt" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-57" vertex="1">
          <mxGeometry x="66" width="66" height="40" as="geometry">
            <mxRectangle width="66" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-60" value="senderId" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-57" vertex="1">
          <mxGeometry x="132" width="78" height="40" as="geometry">
            <mxRectangle width="78" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-61" value="group_id" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-57" vertex="1">
          <mxGeometry x="210" width="70" height="40" as="geometry">
            <mxRectangle width="70" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-62" value="body" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-57" vertex="1">
          <mxGeometry x="280" width="70" height="40" as="geometry">
            <mxRectangle width="70" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-78" value="mentions" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-57" vertex="1">
          <mxGeometry x="350" width="70" height="40" as="geometry">
            <mxRectangle width="70" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-70" value="Group Read Receipts" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;" parent="1" vertex="1">
          <mxGeometry x="960" y="790" width="492" height="70" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-71" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="UpVBmO8LdcwkQg-ua9Jf-70" vertex="1">
          <mxGeometry y="30" width="492" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-72" value="gid" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-71" vertex="1">
          <mxGeometry width="82" height="40" as="geometry">
            <mxRectangle width="82" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-73" value="msg_id" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-71" vertex="1">
          <mxGeometry x="82" width="82" height="40" as="geometry">
            <mxRectangle width="82" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-74" value="seenAt" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-71" vertex="1">
          <mxGeometry x="164" width="76" height="40" as="geometry">
            <mxRectangle width="76" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-75" value="user_id" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-71" vertex="1">
          <mxGeometry x="240" width="88" height="40" as="geometry">
            <mxRectangle width="88" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-76" value="deliveredAt" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-71" vertex="1">
          <mxGeometry x="328" width="82" height="40" as="geometry">
            <mxRectangle width="82" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-95" value="id:uuid" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-71" vertex="1">
          <mxGeometry x="410" width="82" height="40" as="geometry">
            <mxRectangle width="82" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-79" value="1:1 Message (sharded | Hbase)" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;" parent="1" vertex="1">
          <mxGeometry x="1220" y="550" width="420" height="70" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-80" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="UpVBmO8LdcwkQg-ua9Jf-79" vertex="1">
          <mxGeometry y="30" width="420" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-81" value="message_id" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-80" vertex="1">
          <mxGeometry width="66" height="40" as="geometry">
            <mxRectangle width="66" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-82" value="sentAt" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-80" vertex="1">
          <mxGeometry x="66" width="66" height="40" as="geometry">
            <mxRectangle width="66" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-83" value="senderId" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-80" vertex="1">
          <mxGeometry x="132" width="78" height="40" as="geometry">
            <mxRectangle width="78" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-84" value="recipient_id" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-80" vertex="1">
          <mxGeometry x="210" width="70" height="40" as="geometry">
            <mxRectangle width="70" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-85" value="body" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-80" vertex="1">
          <mxGeometry x="280" width="70" height="40" as="geometry">
            <mxRectangle width="70" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-86" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-80" vertex="1">
          <mxGeometry x="350" width="70" height="40" as="geometry">
            <mxRectangle width="70" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-87" value="Unread mention count for group" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;" parent="1" vertex="1">
          <mxGeometry x="960" y="660" width="492" height="70" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-88" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="UpVBmO8LdcwkQg-ua9Jf-87" vertex="1">
          <mxGeometry y="30" width="492" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-89" value="gid" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-88" vertex="1">
          <mxGeometry width="82" height="40" as="geometry">
            <mxRectangle width="82" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-90" value="mention count" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-88" vertex="1">
          <mxGeometry x="82" width="82" height="40" as="geometry">
            <mxRectangle width="82" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-91" value="user_id" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-88" vertex="1">
          <mxGeometry x="164" width="76" height="40" as="geometry">
            <mxRectangle width="76" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-92" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-88" vertex="1">
          <mxGeometry x="240" width="88" height="40" as="geometry">
            <mxRectangle width="88" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-93" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-88" vertex="1">
          <mxGeometry x="328" width="82" height="40" as="geometry">
            <mxRectangle width="82" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-94" value="id:uuid" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-88" vertex="1">
          <mxGeometry x="410" width="82" height="40" as="geometry">
            <mxRectangle width="82" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-96" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;Statefull Service: web sockets&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 12px;&quot;&gt;W&lt;/font&gt;&lt;font style=&quot;font-size: 12px;&quot;&gt;e need to use the web socket real time protocol to deliver the messages instantly to the recipient. However let&#39;s discuss the challenges:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 12px;&quot;&gt;1. Websocket being persistent and stateful there needs to be a service which should tell which client is connected to which WS server in a distributed environment. To achieve this we can use Apache Zookeeper services to register all the servers support web sockets and also maintain all the open connections by userid to propagate messages as soon as we receive.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 12px;&quot;&gt;2. Ideally we should introduce a messaging layer to store the messages from sender as because the client might not have an active connection and we might need to hold the message for sometime or perform retry in failure scenarios.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 12px;&quot;&gt;3. As soon as we receive a message we can put it to a Kafka Topic.&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 12px;&quot;&gt;4. The consumer from Kafka Topic can use the same zookeeper service to find the recipient&#39;s websocket server and send the message if connection is alive. Accordingly it can update few columns like delivered At and also storing the message in Hbase with all the column details.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 12px;&quot;&gt;5. Simultaneously it should also invoke the push notification flow via appropriate Apple Push notification server or Firebase Cloud messaging service to deliver the notifications to the mobile device.Alternatively a browser notification service also needs to be developed.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 12px;&quot;&gt;6.If the message cannot be delivered as mentioned n point 4 the message is safe in Hbase storage and once the client creates the connection then it will use the stateless service to load the message history which can also calculate the number of unread message count based on the lastSeen time which can be cached at the device.&lt;/font&gt;&lt;/div&gt;" style="text;strokeColor=none;align=left;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="780" y="900" width="752" height="270" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-97" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;Final Diagram&lt;/font&gt;" style="text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="60" y="1190" width="590" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-100" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="280" y="1260" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-101" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="UpVBmO8LdcwkQg-ua9Jf-100" vertex="1">
          <mxGeometry width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-102" value="" style="outlineConnect=0;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;shape=mxgraph.aws3.mobile_client;fillColor=#D2D3D3;gradientColor=none;" parent="UpVBmO8LdcwkQg-ua9Jf-100" vertex="1">
          <mxGeometry x="75" y="10" width="30" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-103" value="" style="verticalLabelPosition=bottom;html=1;verticalAlign=top;align=center;strokeColor=none;fillColor=#00BEF2;shape=mxgraph.azure.laptop;pointerEvents=1;" parent="UpVBmO8LdcwkQg-ua9Jf-100" vertex="1">
          <mxGeometry x="10.5" y="15" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-104" value="Load Balancer" style="outlineConnect=0;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;shape=mxgraph.aws3.application_load_balancer;fillColor=#F58536;gradientColor=none;" parent="1" vertex="1">
          <mxGeometry x="180" y="1410" width="69" height="72" as="geometry" />
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-1" value="" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="144.5" y="1610" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-2" value="" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="440" y="1400" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-3" value="" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="430" y="740" width="330" height="210" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-8" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="DUIvn3B8q1NnEX_885ca-3" vertex="1">
          <mxGeometry width="330" height="210" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-15" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="DUIvn3B8q1NnEX_885ca-3" vertex="1">
          <mxGeometry x="30" y="30" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-19" value="Kafka" style="rounded=1;whiteSpace=wrap;html=1;" parent="DUIvn3B8q1NnEX_885ca-3" vertex="1">
          <mxGeometry x="30" y="130" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-20" value="Presence Servers" style="rounded=1;whiteSpace=wrap;html=1;" parent="DUIvn3B8q1NnEX_885ca-3" vertex="1">
          <mxGeometry x="190" y="30" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="UpVBmO8LdcwkQg-ua9Jf-13" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="DUIvn3B8q1NnEX_885ca-3" source="HWvaaGP3WwTQ4oXDmzbK-15" target="HWvaaGP3WwTQ4oXDmzbK-19" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="280" y="310" as="sourcePoint" />
            <mxPoint x="360" y="310" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-16" value="" style="sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#505050;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;outlineConnect=0;align=center;shape=mxgraph.office.servers.application_server_green;" vertex="1" parent="DUIvn3B8q1NnEX_885ca-3">
          <mxGeometry x="40" y="40" width="21" height="40" as="geometry" />
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-17" value="" style="sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#505050;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;outlineConnect=0;align=center;shape=mxgraph.office.servers.application_server_green;" vertex="1" parent="DUIvn3B8q1NnEX_885ca-3">
          <mxGeometry x="79.5" y="40" width="21" height="40" as="geometry" />
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-18" value="" style="sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#505050;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;outlineConnect=0;align=center;shape=mxgraph.office.servers.application_server_green;" vertex="1" parent="DUIvn3B8q1NnEX_885ca-3">
          <mxGeometry x="120" y="40" width="21" height="40" as="geometry" />
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-19" value="Chat Servers" style="text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="DUIvn3B8q1NnEX_885ca-3">
          <mxGeometry x="50" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-13" value="" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="30" y="1030" width="250" height="60" as="geometry" />
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-4" value="" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="DUIvn3B8q1NnEX_885ca-13">
          <mxGeometry width="250" height="60" as="geometry" />
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-5" value="" style="sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#505050;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;outlineConnect=0;align=center;shape=mxgraph.office.servers.application_server_green;" vertex="1" parent="DUIvn3B8q1NnEX_885ca-13">
          <mxGeometry x="24.5" y="10" width="21" height="40" as="geometry" />
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-6" value="" style="sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#505050;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;outlineConnect=0;align=center;shape=mxgraph.office.servers.application_server_green;" vertex="1" parent="DUIvn3B8q1NnEX_885ca-13">
          <mxGeometry x="73.5" y="10" width="21" height="40" as="geometry" />
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-8" value="" style="sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#505050;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;outlineConnect=0;align=center;shape=mxgraph.office.servers.application_server_green;" vertex="1" parent="DUIvn3B8q1NnEX_885ca-13">
          <mxGeometry x="215.5" y="10" width="21" height="40" as="geometry" />
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-10" value="Chat Servers" style="text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="DUIvn3B8q1NnEX_885ca-13">
          <mxGeometry x="120" y="15" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-14" value="Apache ZooKeeper" style="text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="120" y="1100" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="DUIvn3B8q1NnEX_885ca-15" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.464;entryY=-0.017;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="HWvaaGP3WwTQ4oXDmzbK-12" target="DUIvn3B8q1NnEX_885ca-4">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="140" y="980" as="sourcePoint" />
            <mxPoint x="220" y="980" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
