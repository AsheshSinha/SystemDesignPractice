<mxfile host="app.diagrams.net" modified="2024-04-29T15:39:21.807Z" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15" etag="RQrmn9UxHOlV73TKJ03d" version="24.3.1" type="github">
  <diagram name="Page-1" id="3VYbJmwqDZBETqcIFygg">
    <mxGraphModel dx="1586" dy="1190" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-1" value="&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;Questions:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;1. Which type of chat application are we supposed to build? There are mainly two categories of chat applications,&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;First category -&lt;/span&gt;1:1 plus group chats like WhatsApp, messenger.&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;Second is slack , discord, teams like chat application which supports large organisations.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;Ans:  The first category&lt;/span&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;2. Do we need to focus on multi device syncing feature? - yes&lt;/span&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;3. Assuming this would be a global application - yes&lt;/span&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;4. What types of messages are supported ? - text &lt;/span&gt;&lt;/font&gt;&lt;/font&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;only to start with&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;5. What is maximum size of a message ?- 100000 characters&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;6. How many members a group will have ? - max 500&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;7. How many DAU ? - 10 million&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;Based on the answers above we will need to design the following features:&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;1. A one on one with groups supported chat application&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;2. Focus on the backend part&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;Non - functional:&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;1. Highly available&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;2. High scalability&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;BOE - &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;Requests per second - 10 * 10 ^6 * (20 messages per day) / 10 ^ 5 = 2000 messages per second&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;Storage per day - 10 * 10 ^ 6  * 10 * 10 ^ 3  (10KB average message size) = 10 ^ 12 = 1 TB  per day&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;Concepts:&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;The chat application can be separated to 3 different components:&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;1. Stateless services - This will be mainly used for user profile creation/maintenance, Authentication, group creation,&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;User add/removal from groups, read/unread, count of mentions or unread messages etc&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;2. Stateful messaging - This is the core of this application which will support real time message exchanges, typing status, online status&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;3. Third Party integrations - Push notifications for new messages.&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font size=&quot;2&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;" style="text;strokeColor=none;align=left;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="40" y="80" width="690" height="460" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-2" value="&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Chat Application System design&lt;/font&gt;&lt;/div&gt;" style="text;strokeColor=none;align=left;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="40" y="30" width="310" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-3" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;High Level Design&lt;/font&gt;" style="text;strokeColor=none;align=left;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="40" y="548" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-4" value="" style="outlineConnect=0;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;shape=mxgraph.aws3.mobile_client;fillColor=#D2D3D3;gradientColor=none;" parent="1" vertex="1">
          <mxGeometry x="169.5" y="615" width="30" height="40" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-5" value="" style="verticalLabelPosition=bottom;html=1;verticalAlign=top;align=center;strokeColor=none;fillColor=#00BEF2;shape=mxgraph.azure.laptop;pointerEvents=1;" parent="1" vertex="1">
          <mxGeometry x="50" y="676" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-7" value="Load Balancer" style="outlineConnect=0;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;shape=mxgraph.aws3.application_load_balancer;fillColor=#F58536;gradientColor=none;" parent="1" vertex="1">
          <mxGeometry x="150" y="750" width="69" height="72" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-9" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="HWvaaGP3WwTQ4oXDmzbK-4" target="HWvaaGP3WwTQ4oXDmzbK-7" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="480" y="770" as="sourcePoint" />
            <mxPoint x="560" y="770" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-11" value="Hbase - Message storage" style="image;html=1;image=img/lib/clip_art/computers/Database_128x128.png" parent="1" vertex="1">
          <mxGeometry x="580" y="890" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-12" value="App Servers&lt;div&gt;All stateless Service&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="124.5" y="900" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-13" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;curved=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="HWvaaGP3WwTQ4oXDmzbK-7" target="HWvaaGP3WwTQ4oXDmzbK-12" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="490" y="800" as="sourcePoint" />
            <mxPoint x="120" y="930" as="targetPoint" />
            <Array as="points">
              <mxPoint x="70" y="860" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-14" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="HWvaaGP3WwTQ4oXDmzbK-12" target="HWvaaGP3WwTQ4oXDmzbK-16" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="460" y="810" as="sourcePoint" />
            <mxPoint x="540" y="810" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-15" value="Chat Servers&lt;div&gt;Websockets&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="330" y="605" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-16" value="Meta Data storage" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#C925D1;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.rds_postgresql_instance;" parent="1" vertex="1">
          <mxGeometry x="145.5" y="1030" width="78" height="78" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-19" value="Kafka" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="560" y="605" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-20" value="Consumers" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="560" y="730" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-21" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="HWvaaGP3WwTQ4oXDmzbK-15" target="HWvaaGP3WwTQ4oXDmzbK-19" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="380" y="780" as="sourcePoint" />
            <mxPoint x="460" y="780" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-22" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="HWvaaGP3WwTQ4oXDmzbK-19" target="HWvaaGP3WwTQ4oXDmzbK-20" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="430" y="740" as="sourcePoint" />
            <mxPoint x="510" y="740" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-23" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="HWvaaGP3WwTQ4oXDmzbK-20" target="HWvaaGP3WwTQ4oXDmzbK-11" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="470" y="820" as="sourcePoint" />
            <mxPoint x="550" y="820" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-24" value="" style="orthogonalLoop=1;jettySize=auto;html=1;rounded=0;jumpStyle=arc;startArrow=classic;startFill=1;" parent="1" source="HWvaaGP3WwTQ4oXDmzbK-4" target="HWvaaGP3WwTQ4oXDmzbK-15" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="430" y="840" as="sourcePoint" />
            <mxPoint x="510" y="840" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-28" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;curved=0;" parent="1" target="HWvaaGP3WwTQ4oXDmzbK-15" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="560" y="760" as="sourcePoint" />
            <mxPoint x="410" y="730" as="targetPoint" />
            <Array as="points">
              <mxPoint x="390" y="760" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-29" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="HWvaaGP3WwTQ4oXDmzbK-20" target="HWvaaGP3WwTQ4oXDmzbK-7" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="450" y="860" as="sourcePoint" />
            <mxPoint x="530" y="860" as="targetPoint" />
            <Array as="points">
              <mxPoint x="390" y="760" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-30" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;exitX=0.92;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;curved=0;" parent="1" source="HWvaaGP3WwTQ4oXDmzbK-5" target="HWvaaGP3WwTQ4oXDmzbK-7" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="440" y="900" as="sourcePoint" />
            <mxPoint x="520" y="900" as="targetPoint" />
            <Array as="points">
              <mxPoint x="185" y="690" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="HWvaaGP3WwTQ4oXDmzbK-32" value="" style="edgeStyle=none;orthogonalLoop=1;jettySize=auto;html=1;rounded=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;curved=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;startArrow=classic;startFill=1;" parent="1" source="HWvaaGP3WwTQ4oXDmzbK-5" target="HWvaaGP3WwTQ4oXDmzbK-15" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="410" y="950" as="sourcePoint" />
            <mxPoint x="490" y="950" as="targetPoint" />
            <Array as="points">
              <mxPoint x="150" y="520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="y-Os3jITyolEBnI4brBV-3" value="How do we establish real time messaging - We have multiple ways to do it like long polling, short polling and web sockets. However because polling could result it querying for data even when there is no message, it could become expensive option and not a good way of implementing real time communication.&amp;nbsp;&lt;div&gt;Websockets being a persistent bidirectional full duplex connection seems to be an ideal choice.However one challenge with web sockets is that since it&#39;s a stateful connection we would need to maintain the mapping of client and server to transmit the message to the desired party.&lt;/div&gt;" style="text;strokeColor=none;align=left;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="800" y="520" width="620" height="220" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
